<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cuit.business.exhibitor.mapper.ExhibitorMapper">

    <resultMap id="ExhibitorMap" type="com.cuit.business.exhibitor.domain.Exhibitor">
        <result property="id"    column="id"    />
        <result property="uid"    column="uid"    />
        <result property="companyLogo"    column="company_logo"    />
        <result property="companyName"    column="company_name"    />
        <result property="companyInfo"    column="company_info"    />
        <result property="status" column="status"/>
        <result property="delFlag"    column="del_flag"    />
        <result property="createId"    column="create_id"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateId"    column="update_id"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <resultMap id="ExhibitorDTOMap" type="com.cuit.business.exhibitor.domain.dto.ExhibitorDTO">
        <result property="id"    column="id"    />
        <result property="uid"    column="uid"    />
        <result property="exhibitorName"    column="exhibitor_name"    />
        <result property="boothCode" column="booth_code"/>
        <result property="companyLogo"    column="company_logo"    />
        <result property="companyName"    column="company_name"    />
        <result property="companyInfo"    column="company_info"    />
        <result property="status" column="status"/>
        <result property="delFlag"    column="del_flag"    />
        <result property="createId"    column="create_id"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateId"    column="update_id"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>


    <select id="selectIdByUid" resultType="java.lang.Long">
        select id from exhibitor where uid = #{uid}
    </select>

    <sql id="ExhibitorList">
        select e.id,e.uid,u.name as exhibitor_name,
               e.company_logo,e.company_name,e.company_info,e.status,e.del_flag,e.create_id,e.create_time,e.update_id,e.update_time
        from exhibitor e
    </sql>

    <select id="selectExhibitorListByEid" resultType="com.cuit.business.exhibitor.domain.dto.ExhibitorDTO">
        select DISTINCT e.id,e.uid,u.name as exhibitor_name,br.booth_code,
               e.company_logo,e.company_name,e.company_info,e.status,e.del_flag,e.create_id,e.create_time,e.update_id,e.update_time
        from exhibitor e
        left join sys_user u on u.id = e.uid
        left join exhibition_exhibitor ee on ee.etorid = e.id
        left join booth_reservation br on br.etorid = e.id
        where ee.del_flag = '0' and br.del_flag = '0' and br.status = '0' and
            e.del_flag = '0' and e.status = '0' and ee.eid = #{id}
    </select>


    <select id="selectListByPage" resultType="com.cuit.business.exhibitor.domain.dto.ExhibitorDTO">
        <include refid="ExhibitorList"/>
        left join sys_user u on u.id = e.uid
        <where>
            e.del_flag = '0'
            <if test="status!= null and status!= ''"> and e.status = #{status}</if>
            <if test="exhibitorName!= null and exhibitorName!= ''"> and u.name like concat('%',#{exhibitorName},'%')</if>
            <if test="companyName!= null and companyName!= ''"> and e.company_name like concat('%',#{companyName},'%')</if>
        </where>
    </select>

    <select id="selectListByPageById" resultType="com.cuit.business.exhibitor.domain.dto.ExhibitorDTO">
        <include refid="ExhibitorList"/>
        left join sys_user u on u.id = e.uid
        <where>
            e.del_flag = '0' and e.status = '0' and e.uid = #{id}
        </where>
    </select>

</mapper>
